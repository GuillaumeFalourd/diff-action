name: 'DIFF Action'

description: 'Github Action to compare files using diff'

inputs:
    first_file_path:
        description: 'repo/path/file.txt'
        required: true
    second_file_path:
        description: 'repo/path/file.txt'
        required: true
    expected_result:
        description: 'passed or failed'
        required: false
        default: passed

outputs:
  random-number:
    description: "Diff output"
    value: ${{ steps.diff.outputs.diff }}

# runs:
#     using: 'docker'
#     image: 'Dockerfile'
#     args:
#         - ${{ inputs.first_file_path }}
#         - ${{ inputs.second_file_path }}

runs:
  using: "composite"
  steps:

    - id: diff
      run: |
        echo First     
        if diff ${{ inputs.first_file_path }} ${{ inputs.second_file_path }} >/dev/null
        then
          result=$(echo "passed")
        else
          result=$(echo "failed")
        fi
        echo $result
        echo "::set-output name=diff::$(echo $result)"
      shell: bash

    - run: |
        echo Second     
        if echo ${{ steps.diff.outputs.diff }} -eq ${{ inputs.expected_result }}
        then
          echo "Not expected result!" 1>&2
          exit 1
        fi
        echo End
      shell: bash

branding:
    icon: 'terminal'
    color: 'blue'